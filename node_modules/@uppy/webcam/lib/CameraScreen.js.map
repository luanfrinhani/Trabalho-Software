{"version":3,"sources":["CameraScreen.js"],"names":["require","h","Component","SnapshotButton","RecordButton","RecordingLength","VideoSourceSelect","SubmitButton","DiscardButton","isModeAvailable","modes","mode","indexOf","CameraScreen","componentDidMount","onFocus","props","componentWillUnmount","onStop","render","src","recordedVideo","recording","supportsRecording","videoSources","showVideoSourceDropdown","showRecordingLength","onSubmit","i18n","mirror","onSnapshot","onStartRecording","onStopRecording","onDiscardRecordedVideo","recordingLengthSeconds","hasRecordedVideo","shouldShowRecordButton","shouldShowSnapshotButton","shouldShowRecordingLength","shouldShowVideoSourceDropdown","length","videoProps","playsinline","muted","controls","videoElement","srcObject","undefined","autoplay","module","exports"],"mappings":"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","sourcesContent":["/* eslint-disable jsx-a11y/media-has-caption */\nconst { h, Component } = require('preact')\nconst SnapshotButton = require('./SnapshotButton')\nconst RecordButton = require('./RecordButton')\nconst RecordingLength = require('./RecordingLength')\nconst VideoSourceSelect = require('./VideoSourceSelect')\nconst SubmitButton = require('./SubmitButton')\nconst DiscardButton = require('./DiscardButton')\n\nfunction isModeAvailable (modes, mode) {\n  return modes.indexOf(mode) !== -1\n}\n\nclass CameraScreen extends Component {\n  componentDidMount () {\n    const { onFocus } = this.props\n    onFocus()\n  }\n\n  componentWillUnmount () {\n    const { onStop } = this.props\n    onStop()\n  }\n\n  render () {\n    const {\n      src,\n      recordedVideo,\n      recording,\n      modes,\n      supportsRecording,\n      videoSources,\n      showVideoSourceDropdown,\n      showRecordingLength,\n      onSubmit,\n      i18n,\n      mirror,\n      onSnapshot,\n      onStartRecording,\n      onStopRecording,\n      onDiscardRecordedVideo,\n      recordingLengthSeconds,\n    } = this.props\n\n    const hasRecordedVideo = !!recordedVideo\n    const shouldShowRecordButton = !hasRecordedVideo && supportsRecording && (\n      isModeAvailable(modes, 'video-only')\n      || isModeAvailable(modes, 'audio-only')\n      || isModeAvailable(modes, 'video-audio')\n    )\n    const shouldShowSnapshotButton = !hasRecordedVideo && isModeAvailable(modes, 'picture')\n    const shouldShowRecordingLength = supportsRecording && showRecordingLength\n    const shouldShowVideoSourceDropdown = showVideoSourceDropdown && videoSources && videoSources.length > 1\n\n    const videoProps = {\n      playsinline: true,\n    }\n\n    if (recordedVideo) {\n      videoProps.muted = false\n      videoProps.controls = true\n      videoProps.src = recordedVideo\n\n      // reset srcObject in dom. If not resetted, stream sticks in element\n      if (this.videoElement) {\n        this.videoElement.srcObject = undefined\n      }\n    } else {\n      videoProps.muted = true\n      videoProps.autoplay = true\n      videoProps.srcObject = src\n    }\n\n    return (\n      <div className=\"uppy uppy-Webcam-container\">\n        <div className=\"uppy-Webcam-videoContainer\">\n          <video\n            /* eslint-disable-next-line no-return-assign */\n            ref={(videoElement) => (this.videoElement = videoElement)}\n            className={`uppy-Webcam-video  ${mirror ? 'uppy-Webcam-video--mirrored' : ''}`}\n            /* eslint-disable-next-line react/jsx-props-no-spreading */\n            {...videoProps}\n          />\n        </div>\n        <div className=\"uppy-Webcam-footer\">\n          <div className=\"uppy-Webcam-videoSourceContainer\">\n            {shouldShowVideoSourceDropdown\n              ? VideoSourceSelect(this.props)\n              : null}\n          </div>\n          <div className=\"uppy-Webcam-buttonContainer\">\n            {shouldShowSnapshotButton && <SnapshotButton onSnapshot={onSnapshot} i18n={i18n} />}\n\n            {shouldShowRecordButton && (\n              <RecordButton\n                recording={recording}\n                onStartRecording={onStartRecording}\n                onStopRecording={onStopRecording}\n                i18n={i18n}\n              />\n            )}\n\n            {hasRecordedVideo && <SubmitButton onSubmit={onSubmit} i18n={i18n} />}\n\n            {hasRecordedVideo && <DiscardButton onDiscard={onDiscardRecordedVideo} i18n={i18n} />}\n          </div>\n\n          {shouldShowRecordingLength && (\n            <div className=\"uppy-Webcam-recordingLength\">\n              <RecordingLength recordingLengthSeconds={recordingLengthSeconds} i18n={i18n} />\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nmodule.exports = CameraScreen\n"]}